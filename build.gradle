buildscript {
    repositories {
        jcenter()
    }
//noinspection GroovyAssignabilityCheck
    dependencies {
        classpath 'org.javafxports:jfxmobile-plugin:1.0.7'
    }
}

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'org.javafxports.jfxmobile'

repositories {
    mavenCentral()
    jcenter()
    maven {
        url 'http://nexus.gluonhq.com/nexus/content/repositories/releases/'
    }
}

//noinspection GroovyAssignabilityCheck
dependencies {
    compile 'net.sourceforge.streamsupport:streamsupport:1.4.2'
    desktopRuntime 'org.xerial:sqlite-jdbc:3.8.11.2'
    androidRuntime 'org.sqldroid:sqldroid:1.0.3'
    compile 'com.google.code.gson:gson:2.4'
    compile 'com.google.guava:guava:19.0'
    compile 'commons-io:commons-io:2.4'
    compile 'org.apache.commons:commons-lang3:3.4'
    compile 'io.netty:netty-all:5.0.0.Alpha2'
    compile 'com.google.protobuf:protobuf-java:3.0.0-beta-2'
    compile 'com.annimon:stream:1.0.6'
    compile 'com.gluonhq:charm:2.1.0'
    desktopRuntime 'com.gluonhq:charm-desktop:2.1.0'
    androidRuntime 'com.gluonhq:charm-android:2.1.0'
    // compile 'com.airhacks:afterburner.mfx:1.6.2'
    //  runtime 'javax.annotation:javax.annotation-api:1.2'
}

//noinspection GroovyUnusedAssignment
mainClassName = 'fr.galaxyoyo.gatherplaying.Main'
//noinspection GroovyUnusedAssignment
sourceCompatibility = 1.8
//noinspection GroovyUnusedAssignment
archivesBaseName = "Gather Playing"

jfxmobile {
    android {
        //noinspection GroovyAssignabilityCheck
        manifest = 'src/android/AndroidManifest.xml'
        compileSdkVersion = 23
        packagingOptions {
            exclude 'CERT.RSA'
            exclude 'CERT.SF'
            exclude 'META-INF/INDEX.LIST'
            exclude 'io.netty.versions.properties'
            exclude 'META-INF/LICENSE.txt'
            exclude 'META-INF/MANIFEST.MF'
            exclude 'META-INF/NOTICE.txt'
        }
    }
}

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

tasks.withType(Zip) { task ->
    task.doLast {
        ant.checksum file: it.archivePath
    }
}

//noinspection GroovyAssignabilityCheck
run {
    if (project.hasProperty("appArgs")) {
        //noinspection GroovyAssignabilityCheck
        args Eval.me(appArgs)
        if (side.equals('server'))
            workingDir 'C:\\IDEA Workspace\\Gather Playing\\server'
        else if (side.equals('client'))
            workingDir 'C:\\IDEA Workspace\\Gather Playing\\client'
        else
            workingDir 'C:\\IDEA Workspace\\Gather Playing\\client 2'
    }
}
